<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>üåç Block Charity + Smart NGO & Reward Network</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:'Poppins',sans-serif;
  background:linear-gradient(50deg,#001f3f,#0074D9);
  background-image:url("save.jpg");
  background-size:cover;
  color:rgb(42, 39, 39);
  text-align:center;
  padding:20px;
  min-height:10vh;
}
header h1{
  font-size:2.3rem;
  background:linear-gradient(90deg,#0800ff,#0008ff);
  -webkit-background-clip:text;
  background-clip:text;
  -webkit-text-fill-color:transparent;
  margin-bottom:8px;
}
header p{opacity:.9;margin-bottom:25px}
#searchBox{
  width:60%;
  padding:12px;
  border-radius:12px;
  border:none;
  outline:none;
  background:rgba(255,255,255,0.15);
  color:rgb(30, 29, 29);
  font-size:1rem;
  text-align:center;
  margin-bottom:25px;
  transition:0.3s;
}
#searchBox:focus{background:rgba(255,255,255,0.25)}
.card{
  background:rgba(255,255,255,0.1);
  border-radius:18px;
  padding:20px;
  margin:12px;
  width:280px;
  box-shadow:0 0 20px rgba(0,0,0,0.4);
  backdrop-filter:blur(8px);
  display:inline-block;
  vertical-align:top;
  transition:transform 0.3s,background 0.3s;
}
.card:hover{transform:scale(1.05);background:rgba(255,255,255,0.2)}
.card h3{color:#00e6ff;margin-bottom:10px}
button{
  background:linear-gradient(45deg,#00c6ff,#0072ff);
  border:none;
  color:rgb(23, 22, 22);
  padding:10px 16px;
  border-radius:10px;
  cursor:pointer;
  margin-top:10px;
  font-weight:600;
  transition:0.3s;
}
button:hover{opacity:.85}
#alert{background:rgba(0,0,0,0.6);padding:10px;border-radius:10px;margin-top:10px;color:#00ffb3;font-weight:500;display:inline-block}
#wallet{margin:10px 0;color:#b8ffe3;font-size:1rem}
footer{margin-top:40px;font-size:0.9rem;opacity:0.7}
#form, table {
  background-color: rgba(255,255,255,0.1);
  padding: 15px;
  border-radius: 10px;
  margin: 25px auto;
  max-width: 900px;
}
table{border-collapse:collapse;width:100%}
th,td{padding:10px;border:1px solid rgba(255,255,255,0.3);text-align:center}
input{
  padding:8px;margin:5px;border-radius:5px;border:none;
  background:rgba(255,255,255,0.2);color:rgb(3, 3, 3);
}
#charts{
  display:flex;flex-wrap:wrap;justify-content:center;gap:30px;
  max-width:900px;margin:20px auto;
}
#charts canvas{
  background:rgba(255,255,255,0.08);
  border-radius:12px;
  padding:10px;
  width:420px;
  height:300px;
}
h2.sectionTitle{margin-top:40px;color:#00ffb3;text-shadow:0 1px 2px rgba(0,0,0,0.5);}
</style>
</head>
<body>

<header>
  <h1>üåç Block Charity - Bangalore NGO + Rewards Network</h1>
  <p>AI + Blockchain Powered | Transparent | Smart Donations + Rewards</p>
</header>

<input type="text" id="searchBox" placeholder="üîç Search NGO by name or focus...">
<p id="wallet">üîó Wallet not connected</p>
<button onclick="connectWallet()">Connect MetaMask</button>
<div id="alert"></div>

<section id="ngoContainer"></section>

<h2 class="sectionTitle">üí∞ Reward System Dashboard</h2>

<div id="form">
  <input type="text" id="name" placeholder="Donor/NGO Name" />
  <input type="number" id="amount" placeholder="Reward Amount (ETH)" step="any" />
  <input type="text" id="month" placeholder="Month (e.g. November)" />
  <button onclick="addPayment()">Add Reward</button>
</div>

<table id="paymentTable">
  <tr><th>Name</th><th>Amount</th><th>Month</th><th>Timestamp</th></tr>
</table>

<div id="charts">
  <canvas id="lineChart"></canvas>
  <canvas id="pieChart"></canvas>
</div>

<footer>üí° Built for ‚ÄúAir Humanitarian Homes‚Äù & Smart Community Chain</footer>

<script>
const ngoList = [
  {id:1,name:"Air Humanitarian Homes",focus:"Disaster Relief & Humanitarian Aid",location:"Bangalore"},
  {id:2,name:"Green Earth Foundation",focus:"Environment Sustainability",location:"Bangalore"},
  {id:3,name:"CareTrust Bangalore",focus:"Health & Medical Outreach",location:"Bangalore"},
  {id:4,name:"SafeFuture Society",focus:"Child Education & Welfare",location:"Bangalore"},
  {id:5,name:"BlueSky Foundation",focus:"Clean Water & Sanitation",location:"Bangalore"},
  {id:6,name:"HopeBridge NGO",focus:"Women Empowerment & Skill Development",location:"Bangalore"},
  {id:7,name:"Bright Minds Foundation",focus:"Digital Literacy & Education",location:"Bangalore"},
  {id:8,name:"EcoRoots India",focus:"Tree Plantation & Climate Awareness",location:"Bangalore"},
  {id:9,name:"Helping Hands Trust",focus:"Food Distribution & Hunger Relief",location:"Bangalore"},
  {id:10,name:"SmartAid Network",focus:"AI-Based Community Support",location:"Bangalore"},

];

const container=document.getElementById('ngoContainer');
function renderCards(list){
  container.innerHTML="";
  list.forEach(ngo=>{
    const c=document.createElement('div');
    c.className="card";
    c.innerHTML=`
      <h3>${ngo.name}</h3>
      <p><b>Focus:</b> ${ngo.focus}</p>
      <p><b>Location:</b> ${ngo.location}</p>
      <button onclick="donateTo(${ngo.id})">üí∏ Donate</button>`;
    container.appendChild(c);
  });
}
renderCards(ngoList);

document.getElementById("searchBox").addEventListener("input",e=>{
  const q=e.target.value.toLowerCase();
  const filtered=ngoList.filter(n=>n.name.toLowerCase().includes(q)||n.focus.toLowerCase().includes(q));
  renderCards(filtered);
});

let web3,account;
async function connectWallet(){
  if(window.ethereum){
    try{
      await window.ethereum.request({ method:"eth_requestAccounts" });
      web3=new Web3(window.ethereum);
      const accounts=await web3.eth.getAccounts();
      account=accounts[0];
      document.getElementById("wallet").textContent=`‚úÖ Connected: ${account}`;
      showAlert("MetaMask Wallet Connected!");
    }catch(err){
      showAlert("‚ö†Ô∏è Connection Rejected");
    }
  }else{
    alert("Install MetaMask extension!");
  }
}

let payments=[];
const table=document.getElementById("paymentTable");

async function donateTo(id){
  const ngo=ngoList.find(n=>n.id===id);
  if(!account)return showAlert("Connect wallet first!");
  const amount=prompt(`Enter donation (ETH) for ${ngo.name}:`);
  if(!amount||isNaN(amount)||amount<=0)return showAlert("Invalid amount!");
  const wei=web3.utils.toWei(amount,"ether");
  try{
    const tx=await web3.eth.sendTransaction({
      from:account,
      to:"0x58bca990517c8f89fb817a56835b2369e155ac92", // replace with your test address
      value:wei
    });

    const donorName = account.slice(0,6) + "..." + account.slice(-4);
    const month = new Date().toLocaleString('default', { month: 'long' });
    const time = new Date().toLocaleString();

    payments.push({
      name: `${ngo.name} - ${donorName}`,
      amount: parseFloat(amount),
      month,
      time
    });

    updateTable();
    updateCharts();
    showAlert(`üéâ Donation Successful! Tx: ${tx.transactionHash}`);

  }catch(e){showAlert(`‚ùå Failed: ${e.message}`);}
}

function showAlert(msg){
  const box=document.getElementById("alert");
  box.textContent=msg;
  box.style.display="block";
  setTimeout(()=>box.style.display="none",4000);
}

function addPayment(){
  const name=document.getElementById("name").value.trim();
  const amount=parseFloat(document.getElementById("amount").value);
  const month=document.getElementById("month").value.trim();
  if(!name||!amount||!month)return alert("Please fill all fields");
  const time=new Date().toLocaleString();
  payments.push({name,amount,month,time});
  updateTable();
  updateCharts();
  document.getElementById("name").value="";
  document.getElementById("amount").value="";
  document.getElementById("month").value="";
}

function updateTable(){
  table.innerHTML=`<tr><th>Name</th><th>Amount</th><th>Month</th><th>Timestamp</th></tr>`;
  payments.forEach(p=>{
    table.innerHTML+=`<tr><td>${p.name}</td><td>${p.amount} ETH</td><td>${p.month}</td><td>${p.time}</td></tr>`;
  });
}

// ---------- Charts ----------
let lineChart,pieChart;
function updateCharts(){
  const months={};
  payments.forEach(p=>months[p.month]=(months[p.month]||0)+p.amount);
  const ctx1=document.getElementById("lineChart").getContext("2d");
  const ctx2=document.getElementById("pieChart").getContext("2d");
  if(lineChart)lineChart.destroy();
  if(pieChart)pieChart.destroy();
  lineChart=new Chart(ctx1,{
    type:"line",
    data:{labels:Object.keys(months),
      datasets:[{label:"ETH Rewards Over Time",data:Object.values(months),borderColor:"#00ff87",fill:false,tension:0.3}]
    },
    options:{plugins:{legend:{display:true}},scales:{y:{beginAtZero:true}}}
  });
  pieChart=new Chart(ctx2,{
    type:"pie",
    data:{labels:Object.keys(months),
      datasets:[{data:Object.values(months),backgroundColor:["#00e6ff","#00ff87","#ffde59","#ff5f5f","#a85cff"]}]
    }
  });
}
</script>
</body>
</html>
